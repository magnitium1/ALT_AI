<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AltAI - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ API</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 30px;
        }
        .form-group {
            margin-bottom: 15px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #555;
        }
        input[type="text"], input[type="password"], textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
            box-sizing: border-box;
        }
        textarea {
            height: 100px;
            resize: vertical;
        }
        button {
            background-color: #007bff;
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            margin-right: 10px;
        }
        button:hover {
            background-color: #0056b3;
        }
        .success {
            color: #28a745;
            font-weight: bold;
        }
        .error {
            color: #dc3545;
            font-weight: bold;
        }
        .response {
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
            border-left: 4px solid #007bff;
            margin-top: 15px;
            white-space: pre-wrap;
        }
        .tabs {
            display: flex;
            margin-bottom: 20px;
        }
        .tab {
            padding: 10px 20px;
            background-color: #e9ecef;
            border: none;
            cursor: pointer;
            border-radius: 5px 5px 0 0;
            margin-right: 5px;
        }
        .tab.active {
            background-color: #007bff;
            color: white;
        }
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }
    </style>
</head>
<body>
    <h1>ü§ñ AltAI - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ API</h1>
    
    <div class="tabs">
        <button class="tab active" onclick="showTab('register', event)">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button>
        <button class="tab" onclick="showTab('login', event)">–í—Ö–æ–¥</button>
        <button class="tab" onclick="showTab('model', event)">AI –ú–æ–¥–µ–ª—å</button>
    </div>

    <!-- –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è -->
    <div id="register" class="tab-content active">
        <div class="container">
            <h2>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</h2>
            <div class="form-group">
                <label for="reg-username">–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:</label>
                <input type="text" id="reg-username" placeholder="–í–≤–µ–¥–∏—Ç–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è">
            </div>
            <div class="form-group">
                <label for="reg-password">–ü–∞—Ä–æ–ª—å:</label>
                <input type="password" id="reg-password" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å">
            </div>
            <button onclick="register()">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>
            <div id="register-response"></div>
        </div>
    </div>

    <!-- –í—Ö–æ–¥ -->
    <div id="login" class="tab-content">
        <div class="container">
            <h2>–í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É</h2>
            <div class="form-group">
                <label for="login-username">–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:</label>
                <input type="text" id="login-username" placeholder="–í–≤–µ–¥–∏—Ç–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è">
            </div>
            <div class="form-group">
                <label for="login-password">–ü–∞—Ä–æ–ª—å:</label>
                <input type="password" id="login-password" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å">
            </div>
            <button onclick="login()">–í–æ–π—Ç–∏</button>
            <div id="login-response"></div>
        </div>
    </div>

    <!-- AI –ú–æ–¥–µ–ª—å -->
    <div id="model" class="tab-content">
        <div class="container">
            <h2>–ó–∞–ø—Ä–æ—Å –∫ AI –º–æ–¥–µ–ª–∏</h2>
            <div class="form-group">
                <label for="user-request">–í–∞—à –∑–∞–ø—Ä–æ—Å:</label>
                <textarea id="user-request" placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à –≤–æ–ø—Ä–æ—Å –∏–ª–∏ –∑–∞–ø—Ä–æ—Å –∫ AI –º–æ–¥–µ–ª–∏..."></textarea>
            </div>
            <button onclick="requestToModel()">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞–ø—Ä–æ—Å</button>
            <div id="model-response"></div>
        </div>
    </div>

    <script>
        let currentToken = null;

        function showTab(tabName, evt) {
            // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ —Ç–∞–±—ã
            const tabs = document.querySelectorAll('.tab-content');
            tabs.forEach(tab => tab.classList.remove('active'));
            
            // –£–±–∏—Ä–∞–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —É –≤—Å–µ—Ö –∫–Ω–æ–ø–æ–∫
            const tabButtons = document.querySelectorAll('.tab');
            tabButtons.forEach(btn => btn.classList.remove('active'));
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –Ω—É–∂–Ω—ã–π —Ç–∞–±
            document.getElementById(tabName).classList.add('active');
            
            // –î–µ–ª–∞–µ–º –∫–Ω–æ–ø–∫—É –∞–∫—Ç–∏–≤–Ω–æ–π
            (evt?.target || window.event?.target)?.classList.add('active');
        }

        async function register() {
            const username = document.getElementById('reg-username').value;
            const password = document.getElementById('reg-password').value;
            
            if (!username || !password) {
                showResponse('register-response', '–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è', 'error');
                return;
            }

            try {
                const response = await fetch('http://127.0.0.1:8070/register', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ username, password })
                });

                const data = await response.json();
                
                if (response.ok) {
                    showResponse('register-response', '–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞! –¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ –≤–æ–π—Ç–∏ –≤ —Å–∏—Å—Ç–µ–º—É.', 'success');
                    document.getElementById('reg-username').value = '';
                    document.getElementById('reg-password').value = '';
                } else {
                    showResponse('register-response', `–û—à–∏–±–∫–∞: ${data.error}`, 'error');
                }
            } catch (error) {
                showResponse('register-response', `–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è: ${error.message}`, 'error');
            }
        }

        async function login() {
            const username = document.getElementById('login-username').value;
            const password = document.getElementById('login-password').value;
            
            if (!username || !password) {
                showResponse('login-response', '–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è', 'error');
                return;
            }

            try {
                const response = await fetch('http://127.0.0.1:8070/login', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ username, password })
                });

                const data = await response.json();
                
                if (response.ok) {
                    currentToken = data.token;
                    showResponse('login-response', '–í—Ö–æ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω —É—Å–ø–µ—à–Ω–æ! –¢–æ–∫–µ–Ω –ø–æ–ª—É—á–µ–Ω.', 'success');
                    document.getElementById('login-username').value = '';
                    document.getElementById('login-password').value = '';
                } else {
                    showResponse('login-response', `–û—à–∏–±–∫–∞: ${data.error}`, 'error');
                }
            } catch (error) {
                showResponse('login-response', `–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è: ${error.message}`, 'error');
            }
        }

        async function requestToModel() {
            if (!currentToken) {
                showResponse('model-response', '–°–Ω–∞—á–∞–ª–∞ –≤–æ–π–¥–∏—Ç–µ –≤ —Å–∏—Å—Ç–µ–º—É –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–∞!', 'error');
                return;
            }

            const userRequest = document.getElementById('user-request').value;
            
            if (!userRequest) {
                showResponse('model-response', '–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –≤–∞—à –∑–∞–ø—Ä–æ—Å', 'error');
                return;
            }

            try {
                const response = await fetch('http://127.0.0.1:8070/request_to_model', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${currentToken}`
                    },
                    body: JSON.stringify({ request: userRequest })
                });

                const data = await response.json();
                
                if (response.ok) {
                    showResponse('model-response', `–û—Ç–≤–µ—Ç AI –º–æ–¥–µ–ª–∏:\n\n${data?.answer ?? '–ù–µ—Ç –æ—Ç–≤–µ—Ç–∞'}`, 'success');
                } else {
                    showResponse('model-response', `–û—à–∏–±–∫–∞: ${data.error}`, 'error');
                }
            } catch (error) {
                showResponse('model-response', `–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è: ${error.message}`, 'error');
            }
        }

        function showResponse(elementId, message, type) {
            const element = document.getElementById(elementId);
            element.innerHTML = `<div class="response ${type}">${message}</div>`;
        }
    </script>
</body>
</html>

